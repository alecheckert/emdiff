# emdiff
Maximum likelihood estimation for multi-state normal diffusion models

## What does it do?

`emdiff` is an analysis tool for trajectories generated by 
stroboscopic single particle tracking (SPT) experiments. Given
a set of trajectories, it estimates how many molecules are in 
distinct diffusive states, and the diffusion coefficient corresponding
to each state.

`emdiff` models a set of trajectories as an unknown mixture of 
normal diffusive components. Each component is characterized by 
a diffusion coefficient.

## What doesn't it do?

`emdiff` does not check the quality of your raw data.

`emdiff` does not filter out any data. It will consider whatever
data you give it. There is a single optional filter to exclude
trajectories before a start frame, but that's it.

`emdiff` does not decide how many diffusive states are present
in your data.

`emdiff` does not provide any visualizations of the result.

`emdiff` expects you to understand your own experiment, knowing
the frame interval, approximate localization error, and pixel size.

While `emdiff` supports analysis in any number of spatial dimensions,
it uses the same localization error along each dimension. This is 
generally not true for SPT experiments in 3D with increased axial 
localization error.

## Expected input

`emdiff` takes trajectories as a `pandas.DataFrame`. Each row of 
the dataframe should correspond to a localization in the 
trajectory. The dataframe must contain at minimum:

 - a `trajectory` column, with the index of the corresponding trajectory;
 - a `frame` column, with the index of the corresponding frame;
 - position columns such as `y` and `x`

## Example usage
```
    from emdiff import emdiff
    state_occupations, diff_coefs = emdiff(
        tracks,
        n_states=2,
        pixel_size_um=1.0,       # um
        frame_interval=0.00748,  # seconds
        loc_error=0.035,         # um
    )
```

## What do I do with the result?

Up to you.
